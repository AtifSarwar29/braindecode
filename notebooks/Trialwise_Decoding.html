

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trialwise Decoding &mdash; Braindecode 0.4.85 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Braindecode 0.4.85 documentation" href="../index.html"/>
        <link rel="next" title="Cropped Decoding" href="Cropped_Decoding.html"/>
        <link rel="prev" title="Welcome to Braindecode" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.4.85
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trialwise Decoding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Enable-logging">Enable logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-data-to-Braindecode-format">Convert data to Braindecode format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-the-training">Run the training</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Evaluation">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-references">Dataset references</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Trialwise_Manual_Training_Loop.html">Trialwise Manual Training Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Manual_Training_Loop.html">Cropped Manual Training Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization/Perturbation.html">Amplitude Perturbation Visualization</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.visualization.html">braindecode.visualization package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Trialwise Decoding</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Trialwise_Decoding.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Trialwise-Decoding">
<h1>Trialwise Decoding<a class="headerlink" href="#Trialwise-Decoding" title="Permalink to this headline">¶</a></h1>
<p>In this example, we will use a convolutional neural network on the <a class="reference external" href="https://www.physionet.org/physiobank/database/eegmmidb/">Physiobank EEG Motor Movement/Imagery Dataset</a> to decode two classes:</p>
<ol class="arabic simple">
<li>Executed and imagined opening and closing of both hands</li>
<li>Executed and imagined opening and closing of both feet</li>
</ol>
<div class="admonition warning">
We use only one subject (with 90 trials) in this tutorial for demonstration purposes. A more interesting decoding task with many more trials would be to do cross-subject decoding on the same dataset.</div>
<div class="section" id="Enable-logging">
<h2>Enable logging<a class="headerlink" href="#Enable-logging" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import logging
import importlib
importlib.reload(logging) # see https://stackoverflow.com/a/21475297/1469195
log = logging.getLogger()
log.setLevel(&#39;INFO&#39;)
import sys

logging.basicConfig(format=&#39;%(asctime)s %(levelname)s : %(message)s&#39;,
                     level=logging.INFO, stream=sys.stdout)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<p>You can load and preprocess your EEG dataset in any way, Braindecode only expects a 3darray (trials, channels, timesteps) of input signals <code class="docutils literal"><span class="pre">X</span></code> and a vector of labels <code class="docutils literal"><span class="pre">y</span></code> later (see below). In this tutorial, we will use the <a class="reference external" href="https://www.martinos.org/mne/stable/index.html">MNE</a> library to load an EEG motor imagery/motor execution dataset. For a tutorial from MNE using Common Spatial Patterns to decode this data, see
<a class="reference external" href="http://martinos.org/mne/stable/auto_examples/decoding/plot_decoding_csp_eeg.html">here</a>. For another library useful for loading EEG data, take a look at <a class="reference external" href="https://pythonhosted.org/neo/io.html">Neo IO</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import mne
from mne.io import concatenate_raws

# 5,6,7,10,13,14 are codes for executed and imagined hands/feet
subject_id = 22 # carefully cherry-picked to give nice results on such limited data :)
event_codes = [5,6,9,10,13,14]
#event_codes = [3,4,5,6,7,8,9,10,11,12,13,14]

# This will download the files if you don&#39;t have them yet,
# and then return the paths to the files.
physionet_paths = mne.datasets.eegbci.load_data(subject_id, event_codes)

# Load each of the files
parts = [mne.io.read_raw_edf(path, preload=True,stim_channel=&#39;auto&#39;, verbose=&#39;WARNING&#39;)
         for path in physionet_paths]

# Concatenate them
raw = concatenate_raws(parts)

# Find the events in this dataset
events, _ = mne.events_from_annotations(raw)

# Use only EEG channels
eeg_channel_inds = mne.pick_types(raw.info, meg=False, eeg=True, stim=False, eog=False,
                   exclude=&#39;bads&#39;)

# Extract trials, only using EEG channels
epoched = mne.Epochs(raw, events, dict(hands_or_left=2, feet_or_right=3), tmin=1, tmax=4.1, proj=False, picks=eeg_channel_inds,
                baseline=None, preload=True)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Convert-data-to-Braindecode-format">
<h2>Convert data to Braindecode format<a class="headerlink" href="#Convert-data-to-Braindecode-format" title="Permalink to this headline">¶</a></h2>
<p>Braindecode has a minimalistic <code class="docutils literal"><span class="pre">SignalAndTarget</span></code> class, with attributes <code class="docutils literal"><span class="pre">X</span></code> for the signal and <code class="docutils literal"><span class="pre">y</span></code> for the labels. <code class="docutils literal"><span class="pre">X</span></code> should have these dimensions: trials x channels x timesteps. <code class="docutils literal"><span class="pre">y</span></code> should have one label per trial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import numpy as np
# Convert data from volt to millivolt
# Pytorch expects float32 for input and int64 for labels.
X = (epoched.get_data() * 1e6).astype(np.float32)
y = (epoched.events[:,2] - 2).astype(np.int64) #2,3 -&gt; 0,1
</pre></div>
</div>
</div>
<p>We use the first 40 trials for training and the next 30 trials for validation. The validation accuracies can be used to tune hyperparameters such as learning rate etc. The final 20 trials are split apart so we have a final hold-out evaluation set that is not part of any hyperparameter optimization. As mentioned before, this dataset is dangerously small to get any meaningful results and only used here for quick demonstration purposes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>from braindecode.datautil.signal_target import SignalAndTarget

train_set = SignalAndTarget(X[:40], y=y[:40])
valid_set = SignalAndTarget(X[40:70], y=y[40:70])

</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">¶</a></h2>
<p>Braindecode comes with some predefined convolutional neural network architectures for raw time-domain EEG. Here, we use the shallow ConvNet model from <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep learning with convolutional neural networks for EEG decoding and visualization</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>from braindecode.models.shallow_fbcsp import ShallowFBCSPNet
from torch import nn
from braindecode.torch_ext.util import set_random_seeds

# Set if you want to use GPU
# You can also use torch.cuda.is_available() to determine if cuda is available on your machine.
cuda = False
set_random_seeds(seed=20170629, cuda=cuda)
n_classes = 2
in_chans = train_set.X.shape[1]
# final_conv_length = auto ensures we only get a single output in the time dimension
model = ShallowFBCSPNet(in_chans=in_chans, n_classes=n_classes,
                        input_time_length=train_set.X.shape[2],
                        final_conv_length=&#39;auto&#39;)
if cuda:
    model.cuda()

</pre></div>
</div>
</div>
<p>We use <a class="reference external" href="https://arxiv.org/abs/1711.05101">AdamW</a> to optimize the parameters of our network together with <a class="reference external" href="https://arxiv.org/abs/1608.03983">Cosine Annealing</a> of the learning rate. We supply some default parameters that we have found to work well for motor decoding, however we strongly encourage you to perform your own hyperparameter optimization using cross validation on your training data.</p>
<div class="admonition note">
We will now use the Braindecode model class directly to perform the training in a few lines of code. If you instead want to use your own training loop, have a look at the <a class="reference external" href="./TrialWise_LowLevel.html">Trialwise Low-Level Tutorial</a>.</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>from braindecode.torch_ext.optimizers import AdamW
import torch.nn.functional as F
#optimizer = AdamW(model.parameters(), lr=1*0.01, weight_decay=0.5*0.001) # these are good values for the deep model
optimizer = AdamW(model.parameters(), lr=0.0625 * 0.01, weight_decay=0)
model.compile(loss=F.nll_loss, optimizer=optimizer, iterator_seed=1,)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-the-training">
<h2>Run the training<a class="headerlink" href="#Run-the-training" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>model.fit(train_set.X, train_set.y, epochs=30, batch_size=64, scheduler=&#39;cosine&#39;,
         validation_data=(valid_set.X, valid_set.y),)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-05-27 13:45:17,834 INFO : Run until first stop...
2019-05-27 13:45:18,483 INFO : Epoch 0
2019-05-27 13:45:18,485 INFO : train_loss                5.34665
2019-05-27 13:45:18,485 INFO : valid_loss                5.13145
2019-05-27 13:45:18,486 INFO : train_misclass            0.47500
2019-05-27 13:45:18,486 INFO : valid_misclass            0.46667
2019-05-27 13:45:18,487 INFO : runtime                   0.00000
2019-05-27 13:45:18,488 INFO :
2019-05-27 13:45:19,574 INFO : Time only for training updates: 1.09s
2019-05-27 13:45:20,319 INFO : Epoch 1
2019-05-27 13:45:20,322 INFO : train_loss                1.18747
2019-05-27 13:45:20,324 INFO : valid_loss                1.44545
2019-05-27 13:45:20,325 INFO : train_misclass            0.45000
2019-05-27 13:45:20,327 INFO : valid_misclass            0.53333
2019-05-27 13:45:20,329 INFO : runtime                   1.74098
2019-05-27 13:45:20,330 INFO :
2019-05-27 13:45:21,350 INFO : Time only for training updates: 1.02s
2019-05-27 13:45:22,071 INFO : Epoch 2
2019-05-27 13:45:22,074 INFO : train_loss                0.97473
2019-05-27 13:45:22,076 INFO : valid_loss                1.21793
2019-05-27 13:45:22,077 INFO : train_misclass            0.40000
2019-05-27 13:45:22,079 INFO : valid_misclass            0.50000
2019-05-27 13:45:22,081 INFO : runtime                   1.77702
2019-05-27 13:45:22,082 INFO :
2019-05-27 13:45:23,099 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:23,833 INFO : Epoch 3
2019-05-27 13:45:23,836 INFO : train_loss                0.67758
2019-05-27 13:45:23,838 INFO : valid_loss                0.90153
2019-05-27 13:45:23,839 INFO : train_misclass            0.30000
2019-05-27 13:45:23,841 INFO : valid_misclass            0.40000
2019-05-27 13:45:23,843 INFO : runtime                   1.74868
2019-05-27 13:45:23,844 INFO :
2019-05-27 13:45:24,854 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:25,586 INFO : Epoch 4
2019-05-27 13:45:25,589 INFO : train_loss                0.44457
2019-05-27 13:45:25,591 INFO : valid_loss                0.67692
2019-05-27 13:45:25,592 INFO : train_misclass            0.27500
2019-05-27 13:45:25,594 INFO : valid_misclass            0.30000
2019-05-27 13:45:25,596 INFO : runtime                   1.75507
2019-05-27 13:45:25,597 INFO :
2019-05-27 13:45:26,624 INFO : Time only for training updates: 1.03s
2019-05-27 13:45:27,406 INFO : Epoch 5
2019-05-27 13:45:27,409 INFO : train_loss                0.29853
2019-05-27 13:45:27,410 INFO : valid_loss                0.55171
2019-05-27 13:45:27,412 INFO : train_misclass            0.20000
2019-05-27 13:45:27,414 INFO : valid_misclass            0.20000
2019-05-27 13:45:27,415 INFO : runtime                   1.77113
2019-05-27 13:45:27,417 INFO :
2019-05-27 13:45:28,837 INFO : Time only for training updates: 1.42s
2019-05-27 13:45:29,965 INFO : Epoch 6
2019-05-27 13:45:29,968 INFO : train_loss                0.21160
2019-05-27 13:45:29,970 INFO : valid_loss                0.50791
2019-05-27 13:45:29,971 INFO : train_misclass            0.10000
2019-05-27 13:45:29,973 INFO : valid_misclass            0.16667
2019-05-27 13:45:29,975 INFO : runtime                   2.21169
2019-05-27 13:45:29,976 INFO :
2019-05-27 13:45:31,564 INFO : Time only for training updates: 1.59s
2019-05-27 13:45:32,295 INFO : Epoch 7
2019-05-27 13:45:32,298 INFO : train_loss                0.13291
2019-05-27 13:45:32,300 INFO : valid_loss                0.46993
2019-05-27 13:45:32,302 INFO : train_misclass            0.05000
2019-05-27 13:45:32,303 INFO : valid_misclass            0.16667
2019-05-27 13:45:32,305 INFO : runtime                   2.72866
2019-05-27 13:45:32,307 INFO :
2019-05-27 13:45:33,327 INFO : Time only for training updates: 1.02s
2019-05-27 13:45:34,071 INFO : Epoch 8
2019-05-27 13:45:34,074 INFO : train_loss                0.09791
2019-05-27 13:45:34,076 INFO : valid_loss                0.45241
2019-05-27 13:45:34,077 INFO : train_misclass            0.00000
2019-05-27 13:45:34,079 INFO : valid_misclass            0.16667
2019-05-27 13:45:34,081 INFO : runtime                   1.76224
2019-05-27 13:45:34,082 INFO :
2019-05-27 13:45:35,169 INFO : Time only for training updates: 1.08s
2019-05-27 13:45:35,935 INFO : Epoch 9
2019-05-27 13:45:35,938 INFO : train_loss                0.07745
2019-05-27 13:45:35,940 INFO : valid_loss                0.45301
2019-05-27 13:45:35,942 INFO : train_misclass            0.00000
2019-05-27 13:45:35,943 INFO : valid_misclass            0.20000
2019-05-27 13:45:35,945 INFO : runtime                   1.84197
2019-05-27 13:45:35,947 INFO :
2019-05-27 13:45:36,983 INFO : Time only for training updates: 1.03s
2019-05-27 13:45:37,707 INFO : Epoch 10
2019-05-27 13:45:37,710 INFO : train_loss                0.06647
2019-05-27 13:45:37,711 INFO : valid_loss                0.45929
2019-05-27 13:45:37,713 INFO : train_misclass            0.00000
2019-05-27 13:45:37,715 INFO : valid_misclass            0.20000
2019-05-27 13:45:37,716 INFO : runtime                   1.81326
2019-05-27 13:45:37,718 INFO :
2019-05-27 13:45:38,732 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:39,462 INFO : Epoch 11
2019-05-27 13:45:39,465 INFO : train_loss                0.05948
2019-05-27 13:45:39,467 INFO : valid_loss                0.47226
2019-05-27 13:45:39,469 INFO : train_misclass            0.00000
2019-05-27 13:45:39,470 INFO : valid_misclass            0.20000
2019-05-27 13:45:39,472 INFO : runtime                   1.74926
2019-05-27 13:45:39,473 INFO :
2019-05-27 13:45:40,488 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:41,211 INFO : Epoch 12
2019-05-27 13:45:41,214 INFO : train_loss                0.05326
2019-05-27 13:45:41,215 INFO : valid_loss                0.48799
2019-05-27 13:45:41,217 INFO : train_misclass            0.00000
2019-05-27 13:45:41,219 INFO : valid_misclass            0.20000
2019-05-27 13:45:41,220 INFO : runtime                   1.75707
2019-05-27 13:45:41,222 INFO :
2019-05-27 13:45:42,236 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:42,997 INFO : Epoch 13
2019-05-27 13:45:43,000 INFO : train_loss                0.04709
2019-05-27 13:45:43,001 INFO : valid_loss                0.50407
2019-05-27 13:45:43,003 INFO : train_misclass            0.00000
2019-05-27 13:45:43,005 INFO : valid_misclass            0.20000
2019-05-27 13:45:43,007 INFO : runtime                   1.74734
2019-05-27 13:45:43,009 INFO :
2019-05-27 13:45:44,112 INFO : Time only for training updates: 1.10s
2019-05-27 13:45:44,842 INFO : Epoch 14
2019-05-27 13:45:44,844 INFO : train_loss                0.04247
2019-05-27 13:45:44,846 INFO : valid_loss                0.50820
2019-05-27 13:45:44,848 INFO : train_misclass            0.00000
2019-05-27 13:45:44,849 INFO : valid_misclass            0.20000
2019-05-27 13:45:44,851 INFO : runtime                   1.87550
2019-05-27 13:45:44,853 INFO :
2019-05-27 13:45:45,869 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:46,605 INFO : Epoch 15
2019-05-27 13:45:46,608 INFO : train_loss                0.03919
2019-05-27 13:45:46,610 INFO : valid_loss                0.51205
2019-05-27 13:45:46,611 INFO : train_misclass            0.00000
2019-05-27 13:45:46,613 INFO : valid_misclass            0.20000
2019-05-27 13:45:46,615 INFO : runtime                   1.75688
2019-05-27 13:45:46,616 INFO :
2019-05-27 13:45:47,633 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:48,365 INFO : Epoch 16
2019-05-27 13:45:48,368 INFO : train_loss                0.03620
2019-05-27 13:45:48,370 INFO : valid_loss                0.51271
2019-05-27 13:45:48,371 INFO : train_misclass            0.00000
2019-05-27 13:45:48,373 INFO : valid_misclass            0.20000
2019-05-27 13:45:48,374 INFO : runtime                   1.76364
2019-05-27 13:45:48,376 INFO :
2019-05-27 13:45:49,392 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:50,111 INFO : Epoch 17
2019-05-27 13:45:50,114 INFO : train_loss                0.03297
2019-05-27 13:45:50,116 INFO : valid_loss                0.50701
2019-05-27 13:45:50,117 INFO : train_misclass            0.00000
2019-05-27 13:45:50,119 INFO : valid_misclass            0.16667
2019-05-27 13:45:50,121 INFO : runtime                   1.75996
2019-05-27 13:45:50,123 INFO :
2019-05-27 13:45:51,134 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:51,858 INFO : Epoch 18
2019-05-27 13:45:51,860 INFO : train_loss                0.03033
2019-05-27 13:45:51,862 INFO : valid_loss                0.50634
2019-05-27 13:45:51,864 INFO : train_misclass            0.00000
2019-05-27 13:45:51,865 INFO : valid_misclass            0.16667
2019-05-27 13:45:51,867 INFO : runtime                   1.74143
2019-05-27 13:45:51,869 INFO :
2019-05-27 13:45:52,946 INFO : Time only for training updates: 1.08s
2019-05-27 13:45:53,671 INFO : Epoch 19
2019-05-27 13:45:53,674 INFO : train_loss                0.02815
2019-05-27 13:45:53,675 INFO : valid_loss                0.50780
2019-05-27 13:45:53,677 INFO : train_misclass            0.00000
2019-05-27 13:45:53,679 INFO : valid_misclass            0.16667
2019-05-27 13:45:53,680 INFO : runtime                   1.81164
2019-05-27 13:45:53,682 INFO :
2019-05-27 13:45:54,690 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:55,414 INFO : Epoch 20
2019-05-27 13:45:55,417 INFO : train_loss                0.02614
2019-05-27 13:45:55,418 INFO : valid_loss                0.51158
2019-05-27 13:45:55,420 INFO : train_misclass            0.00000
2019-05-27 13:45:55,422 INFO : valid_misclass            0.16667
2019-05-27 13:45:55,424 INFO : runtime                   1.74491
2019-05-27 13:45:55,425 INFO :
2019-05-27 13:45:56,435 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:57,163 INFO : Epoch 21
2019-05-27 13:45:57,166 INFO : train_loss                0.02446
2019-05-27 13:45:57,168 INFO : valid_loss                0.51534
2019-05-27 13:45:57,169 INFO : train_misclass            0.00000
2019-05-27 13:45:57,171 INFO : valid_misclass            0.16667
2019-05-27 13:45:57,173 INFO : runtime                   1.74495
2019-05-27 13:45:57,174 INFO :
2019-05-27 13:45:58,181 INFO : Time only for training updates: 1.01s
2019-05-27 13:45:58,907 INFO : Epoch 22
2019-05-27 13:45:58,910 INFO : train_loss                0.02319
2019-05-27 13:45:58,911 INFO : valid_loss                0.51801
2019-05-27 13:45:58,913 INFO : train_misclass            0.00000
2019-05-27 13:45:58,915 INFO : valid_misclass            0.16667
2019-05-27 13:45:58,916 INFO : runtime                   1.74666
2019-05-27 13:45:58,918 INFO :
2019-05-27 13:45:59,961 INFO : Time only for training updates: 1.04s
2019-05-27 13:46:00,709 INFO : Epoch 23
2019-05-27 13:46:00,711 INFO : train_loss                0.02210
2019-05-27 13:46:00,713 INFO : valid_loss                0.52047
2019-05-27 13:46:00,715 INFO : train_misclass            0.00000
2019-05-27 13:46:00,716 INFO : valid_misclass            0.16667
2019-05-27 13:46:00,718 INFO : runtime                   1.77873
2019-05-27 13:46:00,720 INFO :
2019-05-27 13:46:01,750 INFO : Time only for training updates: 1.03s
2019-05-27 13:46:02,475 INFO : Epoch 24
2019-05-27 13:46:02,477 INFO : train_loss                0.02131
2019-05-27 13:46:02,479 INFO : valid_loss                0.52308
2019-05-27 13:46:02,481 INFO : train_misclass            0.00000
2019-05-27 13:46:02,482 INFO : valid_misclass            0.16667
2019-05-27 13:46:02,484 INFO : runtime                   1.78904
2019-05-27 13:46:02,486 INFO :
2019-05-27 13:46:03,495 INFO : Time only for training updates: 1.01s
2019-05-27 13:46:04,222 INFO : Epoch 25
2019-05-27 13:46:04,225 INFO : train_loss                0.02070
2019-05-27 13:46:04,227 INFO : valid_loss                0.52473
2019-05-27 13:46:04,228 INFO : train_misclass            0.00000
2019-05-27 13:46:04,230 INFO : valid_misclass            0.16667
2019-05-27 13:46:04,232 INFO : runtime                   1.74557
2019-05-27 13:46:04,233 INFO :
2019-05-27 13:46:05,245 INFO : Time only for training updates: 1.01s
2019-05-27 13:46:05,973 INFO : Epoch 26
2019-05-27 13:46:05,976 INFO : train_loss                0.02029
2019-05-27 13:46:05,978 INFO : valid_loss                0.52578
2019-05-27 13:46:05,979 INFO : train_misclass            0.00000
2019-05-27 13:46:05,981 INFO : valid_misclass            0.16667
2019-05-27 13:46:05,983 INFO : runtime                   1.74980
2019-05-27 13:46:05,984 INFO :
2019-05-27 13:46:07,009 INFO : Time only for training updates: 1.02s
2019-05-27 13:46:07,731 INFO : Epoch 27
2019-05-27 13:46:07,734 INFO : train_loss                0.02002
2019-05-27 13:46:07,736 INFO : valid_loss                0.52576
2019-05-27 13:46:07,737 INFO : train_misclass            0.00000
2019-05-27 13:46:07,739 INFO : valid_misclass            0.16667
2019-05-27 13:46:07,741 INFO : runtime                   1.76430
2019-05-27 13:46:07,742 INFO :
2019-05-27 13:46:08,749 INFO : Time only for training updates: 1.01s
2019-05-27 13:46:09,489 INFO : Epoch 28
2019-05-27 13:46:09,491 INFO : train_loss                0.01986
2019-05-27 13:46:09,493 INFO : valid_loss                0.52516
2019-05-27 13:46:09,495 INFO : train_misclass            0.00000
2019-05-27 13:46:09,496 INFO : valid_misclass            0.16667
2019-05-27 13:46:09,498 INFO : runtime                   1.73994
2019-05-27 13:46:09,500 INFO :
2019-05-27 13:46:10,512 INFO : Time only for training updates: 1.01s
2019-05-27 13:46:11,233 INFO : Epoch 29
2019-05-27 13:46:11,236 INFO : train_loss                0.01978
2019-05-27 13:46:11,238 INFO : valid_loss                0.52423
2019-05-27 13:46:11,239 INFO : train_misclass            0.00000
2019-05-27 13:46:11,241 INFO : valid_misclass            0.16667
2019-05-27 13:46:11,243 INFO : runtime                   1.76238
2019-05-27 13:46:11,244 INFO :
2019-05-27 13:46:12,273 INFO : Time only for training updates: 1.03s
2019-05-27 13:46:12,997 INFO : Epoch 30
2019-05-27 13:46:13,000 INFO : train_loss                0.01976
2019-05-27 13:46:13,002 INFO : valid_loss                0.52316
2019-05-27 13:46:13,004 INFO : train_misclass            0.00000
2019-05-27 13:46:13,005 INFO : valid_misclass            0.16667
2019-05-27 13:46:13,007 INFO : runtime                   1.76154
2019-05-27 13:46:13,009 INFO :
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;braindecode.experiments.experiment.Experiment at 0x7fb488906e80&gt;
</pre></div>
</div>
</div>
<p>The monitored values are also stored into a pandas dataframe:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>model.epochs_df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>train_misclass</th>
      <th>valid_misclass</th>
      <th>runtime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.346649</td>
      <td>5.131454</td>
      <td>0.475</td>
      <td>0.466667</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.187472</td>
      <td>1.445452</td>
      <td>0.450</td>
      <td>0.533333</td>
      <td>1.740984</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.974734</td>
      <td>1.217927</td>
      <td>0.400</td>
      <td>0.500000</td>
      <td>1.777023</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.677576</td>
      <td>0.901526</td>
      <td>0.300</td>
      <td>0.400000</td>
      <td>1.748683</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.444574</td>
      <td>0.676924</td>
      <td>0.275</td>
      <td>0.300000</td>
      <td>1.755075</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.298528</td>
      <td>0.551715</td>
      <td>0.200</td>
      <td>0.200000</td>
      <td>1.771130</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.211601</td>
      <td>0.507913</td>
      <td>0.100</td>
      <td>0.166667</td>
      <td>2.211694</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.132909</td>
      <td>0.469927</td>
      <td>0.050</td>
      <td>0.166667</td>
      <td>2.728657</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.097908</td>
      <td>0.452408</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.762245</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.077446</td>
      <td>0.453012</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.841966</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.066468</td>
      <td>0.459292</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.813261</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.059477</td>
      <td>0.472259</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.749265</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.053263</td>
      <td>0.487993</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.757071</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.047088</td>
      <td>0.504074</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.747344</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.042468</td>
      <td>0.508204</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.875502</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.039186</td>
      <td>0.512052</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.756878</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.036201</td>
      <td>0.512707</td>
      <td>0.000</td>
      <td>0.200000</td>
      <td>1.763641</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.032971</td>
      <td>0.507012</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.759965</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.030331</td>
      <td>0.506342</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.741430</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.028149</td>
      <td>0.507796</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.811639</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.026143</td>
      <td>0.511578</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.744909</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.024460</td>
      <td>0.515335</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.744946</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.023193</td>
      <td>0.518014</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.746660</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.022102</td>
      <td>0.520473</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.778730</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.021306</td>
      <td>0.523084</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.789039</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.020703</td>
      <td>0.524732</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.745571</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.020286</td>
      <td>0.525779</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.749797</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.020023</td>
      <td>0.525761</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.764305</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.019861</td>
      <td>0.525160</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.739945</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.019783</td>
      <td>0.524232</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.762381</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.019764</td>
      <td>0.523157</td>
      <td>0.000</td>
      <td>0.166667</td>
      <td>1.761538</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Eventually, we arrive at 83.4% accuracy, so 25 from 30 trials are correctly predicted. In the <a class="reference external" href="./Cropped_Decoding.html">Cropped Decoding Tutorial</a>, we can learn how to achieve higher accuracies using cropped training.</p>
</div>
<div class="section" id="Evaluation">
<h2>Evaluation<a class="headerlink" href="#Evaluation" title="Permalink to this headline">¶</a></h2>
<p>Once we have all our hyperparameters and architectural choices done, we can evaluate the accuracies to report in our publication by evaluating on the test set:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>test_set = SignalAndTarget(X[70:], y=y[70:])

model.evaluate(test_set.X, test_set.y)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>{&#39;loss&#39;: 0.43049120903015137,
 &#39;misclass&#39;: 0.19999999999999996,
 &#39;runtime&#39;: 0.00031256675720214844}
</pre></div>
</div>
</div>
<p>We can also retrieve predicted labels per trial as such:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>model.predict_classes(test_set.X)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>array([1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0])
</pre></div>
</div>
</div>
<p>We can also retrieve the raw network outputs per trial as such:</p>
<div class="admonition warning">
Note these are log-softmax outputs, so to get probabilities one would have to exponentiate them using <code class="docutils literal"><span class="pre">th.exp</span></code>.</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>model.predict_outs(test_set.X)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>array([[-3.108049  , -0.0457173 ],
       [-0.18737975, -1.7668451 ],
       [-3.550216  , -0.02913891],
       [-0.00889281, -4.7269597 ],
       [-0.03029956, -3.5117326 ],
       [-0.00847233, -4.775178  ],
       [-4.006974  , -0.01835574],
       [-0.4073605 , -1.0948324 ],
       [-0.02217731, -3.819753  ],
       [-0.22672828, -1.5952262 ],
       [-3.5868406 , -0.02807612],
       [-1.3834822 , -0.28862125],
       [-0.32644472, -1.2782807 ],
       [-1.3229265 , -0.30972955],
       [-0.08954818, -2.4574184 ],
       [-0.0186951 , -3.9888284 ],
       [-0.09142652, -2.4375842 ],
       [-0.24392553, -1.5303771 ],
       [-0.03591001, -3.3446407 ],
       [-0.16686489, -1.8728433 ]], dtype=float32)
</pre></div>
</div>
</div>
<div class="admonition note">
If you want to try cross-subject decoding, changing the loading code to the following will perform cross-subject decoding on imagined left vs right hand closing, with 50 training and 5 validation subjects (Warning, might be very slow if you are on CPU):</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>import mne
import numpy as np
from mne.io import concatenate_raws
from braindecode.datautil.signal_target import SignalAndTarget

# First 50 subjects as train
physionet_paths = [ mne.datasets.eegbci.load_data(sub_id,[4,8,12,]) for sub_id in range(1,51)]
physionet_paths = np.concatenate(physionet_paths)
parts = [mne.io.read_raw_edf(path, preload=True,stim_channel=&#39;auto&#39;)
         for path in physionet_paths]

raw = concatenate_raws(parts)

picks = mne.pick_types(raw.info, meg=False, eeg=True, stim=False, eog=False,
                   exclude=&#39;bads&#39;)

# Find the events in this dataset
events, _ = mne.events_from_annotations(raw)

# Read epochs (train will be done only between 1 and 2s)
# Testing will be done with a running classifier
epoched = mne.Epochs(raw, events, dict(hands=2, feet=3), tmin=1, tmax=4.1, proj=False, picks=picks,
                baseline=None, preload=True)

# 51-55 as validation subjects
physionet_paths_valid = [mne.datasets.eegbci.load_data(sub_id,[4,8,12,]) for sub_id in range(51,56)]
physionet_paths_valid = np.concatenate(physionet_paths_valid)
parts_valid = [mne.io.read_raw_edf(path, preload=True,stim_channel=&#39;auto&#39;)
         for path in physionet_paths_valid]
raw_valid = concatenate_raws(parts_valid)

picks_valid = mne.pick_types(raw_valid.info, meg=False, eeg=True, stim=False, eog=False,
                   exclude=&#39;bads&#39;)

events_valid = mne.find_events(raw_valid, shortest_event=0, stim_channel=&#39;STI 014&#39;)

# Read epochs (train will be done only between 1 and 2s)
# Testing will be done with a running classifier
epoched_valid = mne.Epochs(raw_valid, events_valid, dict(hands=2, feet=3), tmin=1, tmax=4.1, proj=False, picks=picks_valid,
                baseline=None, preload=True)

train_X = (epoched.get_data() * 1e6).astype(np.float32)
train_y = (epoched.events[:,2] - 2).astype(np.int64) #2,3 -&gt; 0,1
valid_X = (epoched_valid.get_data() * 1e6).astype(np.float32)
valid_y = (epoched_valid.events[:,2] - 2).astype(np.int64) #2,3 -&gt; 0,1
train_set = SignalAndTarget(train_X, y=train_y)
valid_set = SignalAndTarget(valid_X, y=valid_y)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Dataset-references">
<h2>Dataset references<a class="headerlink" href="#Dataset-references" title="Permalink to this headline">¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a> instrumentation system, which they used in making these recordings. The system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and growing archive of well-characterized digital recordings of physiologic signals and related data for use by the biomedical research community and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Cropped_Decoding.html" class="btn btn-neutral float-right" title="Cropped Decoding" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Welcome to Braindecode" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.4.85',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>